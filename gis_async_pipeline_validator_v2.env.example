# GIS Async Pipeline Validator v2 - Configuration Example
# Sprint 2 Otimização 5
# Created: 2026-02-06

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================
# Connection to PostgreSQL/Supabase for geometry validation
DATABASE_URL=postgresql://user:password@localhost:5432/villa_canabrava
DB_HOST=localhost
DB_PORT=5432
DB_NAME=villa_canabrava
DB_USER=postgres
DB_PASSWORD=your_password_here

# ============================================================================
# PIPELINE CONFIGURATION
# ============================================================================
# Number of concurrent workers processing geometries
WORKER_COUNT=5

# Number of items per batch (for progress reporting)
BATCH_SIZE=20

# Maximum items in async queue before blocking
QUEUE_MAXSIZE=1000

# ============================================================================
# GEOMETRY VALIDATION
# ============================================================================
# Use ST_MakeValid() for invalid geometries (true/false)
AUTO_FIX_INVALID=true

# Spatial reference system for validation (e.g., 4326 for WGS84)
SRID=4326

# Geometry tolerance (in degrees) for fixing self-intersecting polygons
TOLERANCE=0.00001

# ============================================================================
# PERFORMANCE TUNING
# ============================================================================
# Enable batch aggregation for bulk updates
ENABLE_BATCH_AGGREGATION=true

# Aggregation size (number of results to batch before writing to DB)
AGGREGATION_SIZE=100

# Enable caching of validation results
ENABLE_RESULT_CACHE=false

# Cache TTL in seconds
CACHE_TTL_SECONDS=3600

# ============================================================================
# LOGGING
# ============================================================================
# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Log file path
LOG_FILE=gis_async_pipeline_validator_v2.log

# Enable console logging
LOG_TO_CONSOLE=true

# Enable file logging
LOG_TO_FILE=true

# ============================================================================
# OUTPUT / RESULTS
# ============================================================================
# Output format: json, csv, both
OUTPUT_FORMAT=json

# Output file path for results
OUTPUT_FILE=gis_async_pipeline_results_v2.json

# Save detailed validation results (true/false)
SAVE_DETAILED_RESULTS=true

# ============================================================================
# EXECUTION CONTROL
# ============================================================================
# Dry run mode (validate without writing to DB)
DRY_RUN=false

# Skip failed geometries and continue (true/false)
CONTINUE_ON_ERROR=true

# Maximum geometries to process (0 = unlimited)
MAX_ITEMS=0

# Timeout per item in seconds (0 = no timeout)
TIMEOUT_SECONDS=30

# ============================================================================
# STATISTICS & REPORTING
# ============================================================================
# Generate performance report (true/false)
GENERATE_REPORT=true

# Report output file
REPORT_FILE=gis_async_pipeline_report.txt

# Report metrics to include: validity,performance,distribution,errors
REPORT_METRICS=validity,performance,distribution,errors

# ============================================================================
# MONITORING (Optional)
# ============================================================================
# Enable Prometheus metrics export
ENABLE_PROMETHEUS_METRICS=false

# Prometheus metrics port
PROMETHEUS_PORT=8000

# Prometheus metrics endpoint
PROMETHEUS_ENDPOINT=/metrics

# ============================================================================
# EXAMPLE USAGE
# ============================================================================
# 1. Load configuration:
#    export $(cat gis_async_pipeline_validator_v2.env.example | xargs)
#
# 2. Run pipeline:
#    python gis_async_pipeline_validator_v2.py
#
# 3. Results:
#    gis_async_pipeline_results_v2.json
#    gis_async_pipeline_validator_v2.log
#    gis_async_pipeline_report.txt
