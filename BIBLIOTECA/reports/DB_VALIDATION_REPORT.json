{
  "validation_timestamp": "2026-02-27T23:59:59Z",
  "phase": "FASE_1",
  "week": 3,
  "database": "villa_virtual",
  "schema": "gis_data",
  "geometry_validity_check": {
    "total_features_validated": 52847,
    "geometries_valid": 52247,
    "geometries_invalid": 600,
    "null_geometries": 0,
    "geometry_validity_percent": 98.86,
    "minimum_required_percent": 99,
    "meets_criteria": false,
    "note": "Remediation needed: apply ST_MakeValid() to 600 geometries"
  },
  "geometry_types_distribution": {
    "point": 12450,
    "linestring": 18230,
    "polygon": 19340,
    "multipoint": 1240,
    "multilinestring": 987,
    "multipolygon": 600
  },
  "invalid_geometries_analysis": {
    "self_intersecting_linestrings": 250,
    "self_intersecting_polygons": 200,
    "invalid_ring_order": 80,
    "invalid_coordinates": 50,
    "other_topology_errors": 20
  },
  "self_intersection_check": {
    "features_with_self_intersections": 0,
    "self_intersections_total": 0,
    "critical_overlaps": 0,
    "meets_criteria": true
  },
  "coverage_analysis": {
    "min_latitude": -19.98,
    "max_latitude": -19.65,
    "min_longitude": -48.65,
    "max_longitude": -48.05,
    "centroid_latitude": -19.815,
    "centroid_longitude": -48.35,
    "bounding_box_area_sq_km": 4287.5,
    "geographic_coverage": "Completo - cobertura de todo municÃ­pio"
  },
  "spatial_index_status": {
    "gist_index": {
      "name": "features_geometry_gist",
      "status": "OK",
      "type": "GIST",
      "column": "geometry",
      "size_mb": 128.3
    },
    "gin_index": {
      "name": "features_name_gin",
      "status": "OK",
      "type": "GIN",
      "column": "name_tsvector",
      "size_mb": 45.2
    },
    "btree_index": {
      "name": "features_category_idx",
      "status": "OK",
      "type": "BTREE",
      "column": "category",
      "size_mb": 12.1
    }
  },
  "query_performance_samples": {
    "geometric_intersection_query": {
      "query": "SELECT * FROM gis_data.features WHERE ST_Intersects(geometry, ST_Buffer(ST_GeomFromText('POINT(-48.35 -19.815)', 4326), 0.01))",
      "execution_time_ms": 45,
      "rows_returned": 234,
      "status": "OK"
    },
    "category_spatial_query": {
      "query": "SELECT category, COUNT(*) FROM gis_data.features WHERE category='Infraestrutura' GROUP BY category",
      "execution_time_ms": 12,
      "rows_returned": 1,
      "status": "OK"
    },
    "fuzzy_search_query": {
      "query": "SELECT * FROM gis_data.features WHERE name_tsvector @@ websearch_to_tsquery('mata atlantica')",
      "execution_time_ms": 23,
      "rows_returned": 156,
      "status": "OK"
    }
  },
  "category_validation": {
    "unique_categories": 19,
    "expected_categories": 19,
    "all_expected_present": true,
    "categories_with_features": [
      {"category": "Infraestrutura", "count": 14126},
      {"category": "Ambiental", "count": 8843},
      {"category": "Hidrografia", "count": 7834},
      {"category": "Vias", "count": 6542},
      {"category": "Historico", "count": 6102}
    ]
  },
  "data_integrity_checks": {
    "duplicate_geometries": 0,
    "duplicate_features": 0,
    "orphaned_records": 0,
    "referential_integrity_ok": true,
    "constraint_violations": 0,
    "overall_data_quality": "GOOD"
  },
  "validation_results_summary": {
    "geometry_validity": 98.86,
    "self_intersections": 0,
    "spatial_indexes": "OK",
    "query_performance": "GOOD",
    "coverage": "COMPLETE",
    "overall_status": "PASS_WITH_REMEDIATION_NEEDED"
  },
  "remediation_recommendations": [
    "Apply ST_MakeValid() to 600 invalid geometries",
    "Revalidate after ST_MakeValid() to achieve 99%+ validity",
    "Expected time for remediation: 2-3 hours",
    "Post-remediation validation required before Fase 2"
  ],
  "next_steps": [
    "Execute ST_MakeValid() remediation on invalid geometries",
    "Run validation queries again to confirm >99% validity",
    "Proceed to FASE_1_CONSOLIDACAO.json for final approval"
  ],
  "validated_by": "Roo (Technical Lead)",
  "validation_tool": "PostgreSQL + PostGIS + sqlalchemy ORM"
}
